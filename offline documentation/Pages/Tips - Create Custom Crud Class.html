<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>LCG - Tips - Create Custom Crud Class</title>
	<link rel="stylesheet" type="text/css" href="../Styles/Highlight.css">
	<link rel="stylesheet" type="text/css" href="../Styles/Styles.css">
</head>
<body>
	<h1>Tips - Create Custom Crud Class</h1>
	<section>
		<p>Use the <span class="text-bold">Crud</span> class to inherit the database access methods.</p>
		<pre class="hl"><span class="hl com">// Crud | CustomDomainCrud.cs</span>

<span class="hl kwa">namespace</span> <span class="highlight-text">Com.Example.Labs.Crud</span>
<span class="hl opt">{</span>
    <span class="hl kwa">using</span> System<span class="hl opt">;</span>
    <span class="hl kwa">using</span> System<span class="hl opt">.</span>Collections<span class="hl opt">.</span>Generic<span class="hl opt">;</span>
    <span class="hl kwa">using</span> System<span class="hl opt">.</span>Data<span class="hl opt">;</span>
    <span class="hl kwa">using</span> System<span class="hl opt">.</span>Data<span class="hl opt">.</span>Common<span class="hl opt">;</span>

    <span class="hl kwa">using</span> Com<span class="hl opt">.</span>Example<span class="hl opt">.</span>Labs<span class="hl opt">.</span>Core<span class="hl opt">;</span>
    <span class="hl kwa">using</span> Com<span class="hl opt">.</span>Example<span class="hl opt">.</span>Labs<span class="hl opt">.</span>Models<span class="hl opt">;</span>

    <span class="hl kwa">public class</span> CustomDomainCrud <span class="hl opt">:</span> <span class="highlight-text">Crud</span>
    <span class="hl opt">{</span>
        <span class="hl ppc">#region [ Constructor ]</span>

        <span class="hl slc">// Define the following contructor</span>

        <span class="hl kwa">public</span> <span class="hl kwd">CustomDomainCrud</span><span class="hl opt">(</span>IUserContext userContext<span class="hl opt">)</span>
            <span class="hl opt">:</span> <span class="hl kwa">base</span><span class="hl opt">(</span>userContext<span class="hl opt">)</span>
        <span class="hl opt">{</span>
            <span class="hl kwa">base</span><span class="hl opt">.</span><span class="hl kwd">Initialize</span><span class="hl opt">();</span>
        <span class="hl opt">}</span>

        <span class="hl ppc">#endregion</span>

        <span class="hl ppc">#region [ Public methods ]</span>

        <span class="hl kwa">public</span> IList<span class="hl opt">&lt;</span>CustomDataModel<span class="hl opt">&gt;</span> <span class="hl kwd">GetData</span><span class="hl opt">()</span>
        <span class="hl opt">{</span>
            IList<span class="hl opt">&lt;</span>CustomDataModel<span class="hl opt">&gt;</span> list <span class="hl opt">=</span> <span class="hl kwa">new</span> List<span class="hl opt">&lt;</span>CustomDataModel<span class="hl opt">&gt;();</span>

            DbConnection dbConnection<span class="hl opt">;</span>

            <span class="hl kwa">using</span> <span class="hl opt">(</span><span class="hl kwa">var</span> et <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">ExecutionTracerService</span><span class="hl opt">())</span>
            <span class="hl kwa">using</span> <span class="hl opt">(</span><span class="hl kwa">var</span> dbReader <span class="hl opt">=</span> <span class="hl kwa">base</span><span class="hl opt">.</span><span class="hl kwd">ToDataReader</span><span class="hl opt">(</span><span class="hl str">&quot;CustomDomain_Custom_GetData&quot;</span><span class="hl opt">,</span> <span class="hl kwa">null</span><span class="hl opt">,</span> out dbConnection<span class="hl opt">))</span>
            <span class="hl opt">{</span>
                <span class="hl kwa">while</span> <span class="hl opt">(</span>dbReader<span class="hl opt">.</span><span class="hl kwd">Read</span><span class="hl opt">())</span>
                <span class="hl opt">{</span>
                    CustomDataModel item <span class="hl opt">=</span> <span class="hl kwa">new</span> <span class="hl kwd">CustomDataModel</span><span class="hl opt">();</span>

                    <span class="hl slc">// Mapping...</span>

                    item<span class="hl opt">.</span>Field1 <span class="hl opt">=</span> TypeHelper<span class="hl opt">.</span>To<span class="hl opt">&lt;</span><span class="hl kwb">int</span><span class="hl opt">&gt;(</span>dbReader<span class="hl opt">,</span> <span class="hl str">&quot;Field1&quot;</span><span class="hl opt">);</span>
                    item<span class="hl opt">.</span>Field2 <span class="hl opt">=</span> TypeHelper<span class="hl opt">.</span>To<span class="hl opt">&lt;</span><span class="hl kwb">string</span><span class="hl opt">&gt;(</span>dbReader<span class="hl opt">,</span> <span class="hl str">&quot;Field2&quot;</span><span class="hl opt">);</span>
                    item<span class="hl opt">.</span>Field3 <span class="hl opt">=</span> TypeHelper<span class="hl opt">.</span>To<span class="hl opt">&lt;</span><span class="hl kwb">double</span>?<span class="hl opt">&gt;(</span>dbReader<span class="hl opt">,</span> <span class="hl str">&quot;Field3&quot;</span><span class="hl opt">);</span>

                    list<span class="hl opt">.</span><span class="hl kwd">Add</span><span class="hl opt">(</span>item<span class="hl opt">);</span>
                <span class="hl opt">}</span>
            <span class="hl opt">}</span>

            <span class="hl kwa">if</span> <span class="hl opt">(</span>dbConnection <span class="hl opt">!=</span> <span class="hl kwa">null</span><span class="hl opt">)</span>
                dbConnection<span class="hl opt">.</span><span class="hl kwd">Close</span><span class="hl opt">();</span>

            <span class="hl kwa">return</span> list<span class="hl opt">;</span>
        <span class="hl opt">}</span>

        <span class="hl ppc">#endregion</span>
    <span class="hl opt">}</span>
<span class="hl opt">}</span></pre>
		<div class="box important">
		    <h3>Important</h3>
		    <div class="box-content">To use it over Service &amp; WCF layers do not forget to create the Business class and to generate the associated service using LayerCake Generator Process.</div>
		</div>
		<p>An example can be found in the <span class="text-bold">Crud\AppCrud\CommonCrud.cs</span> &amp; <span class="text-bold">Business\AppBusiness\CommonBusiness.cs</span> files.</p>
	</section>
</body>
</html>
